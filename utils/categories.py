import re

# Таблиця заміни подібних латинських літер на кириличні
SIMILAR_LETTERS = {
    'A': 'А', 'a': 'а',
    'B': 'В', 'E': 'Е', 'e': 'е',
    'K': 'К', 'k': 'к',
    'M': 'М', 'H': 'Н',
    'O': 'О', 'o': 'о',
    'P': 'Р', 'p': 'р',
    'C': 'С', 'c': 'с',
    'T': 'Т', 'X': 'Х',
    'y': 'у', 'Y': 'У',
    '3': 'З',
    'i': 'і', 'I': 'І',
    'r': 'р',
}

def normalize_text(text):
    # Заміна подібних літер
    normalized = ''.join(SIMILAR_LETTERS.get(ch, ch) for ch in text)
    normalized = normalized.lower()
    # Залишаємо тільки літери, цифри і пробіли
    normalized = re.sub(r'[^а-яіїєґa-z0-9 ]', ' ', normalized)
    normalized = re.sub(r'\s+', ' ', normalized).strip()
    return normalized

def categorize(name: str) -> str:
    name = normalize_text(name)

    categories = {
        "алкоголь": ["пиво", "вино", "горілка", "коньяк", "лікер", "ром"],
        "овочі": ["картопля", "морква", "огірок", "капуста", "цибуля", "буряк", "перець", "томат", "помідор", "часник"],
        "фрукти": ["яблуко", "банан", "виноград", "апельсин", "мандарин", "груша", "лимон", "слива", "кавун", "персик"],
        "молочка": ["молоко", "йогурт", "кефір", "сметана", "творог", "вершки", "ряжанка", "масло"],
        "сигарети": ["сигарет", "цигарк", "tobacco", "marlboro", "kent", "camel", "bond", "parliament"],
        "м'ясо та ковбаси": ["ковбас", "сосиск", "бекон", "шинка", "м'ясо", "салямі", "грудинка", "курка", "свинина", "яловичина"],
        "випічка": ["хліб", "булка", "паляниця", "круасан", "бублик", "лаваш", "батон"],
        "каша і крупи": ["гречка", "рис", "пшоно", "ячмінь", "вівсянка", "манка", "перловка", "крупа"],
        "напої": ["сік", "вода", "компот", "квас", "чай", "кава", "лимонад", "газована", "негазована"],
        "снеки та солодощі": ["печиво", "шоколад", "цукер", "батончик", "снек", "вафл", "морозиво", "арахіс", "насіння", "попкорн", "крекер"],
        "соуси і спеції": ["соус", "кетчуп", "майонез", "сіль", "перець", "куркума", "приправа", "гірчиця", "оцет"],
        "побутове": ["пакет", "серветк", "губка", "мішок", "мило", "шампунь", "туалет", "засіб", "порошок", "щітка", "рукавички"],
        "інше": []
    }

    for cat, keywords in categories.items():
        for word in keywords:
            if word in name:
                return cat.capitalize()

    return "Інше"
